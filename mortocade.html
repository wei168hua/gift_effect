<!DOCTYPE html>
<html>
 <head> 
  <meta charset="utf-8" /> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" /> 
  <title>斗鱼车队大全</title>
  <link rel="shortcut icon" href="https://raw.githubusercontent.com/wolf-scream/gift_effect/master/favicon.ico"> 
  <link rel="stylesheet" type="text/css" href="https://raw.githack.com/wolf-scream/gift_effect/master/waterfall.css" />  
  <script src="js/modernizr-custom.js"></script> 
 </head> 
 <body class="demo-1"> 
  <header style="clear:both;"> 
   <!-- <img src="https://raw.githubusercontent.com/wolf-scream/gift_effect/master/favicon.png"> --> 
   <h1 style="text-align: center;color: yellow;">斗鱼车队大全</h1> 
   <div class="collapse" style="white-space: nowrap; text-align:right;  margin-right: 30px; font-size: 22px; color: cyan;">
    <a class="nav-link" style="text-decoration:none;" href="https://popzoo.github.io/barrage/index.html">词云弹幕</a>
    <a class="nav-link" style="text-decoration:none;" href="https://wolf-scream.github.io/gift_effect/index.html">礼物大全</a> 
    <a class="nav-link" style="text-decoration:none;" href="https://wolf-scream.github.io/gift_effect/mortocade.html">车队大全</a>
    <a class="nav-link" style="text-decoration:none;" href="https://greasyfork.org/zh-CN/scripts/389379">G-Fork</a>
    <a class="nav-link" style="text-decoration:none;" href="https://github.com/wolf-scream/motorcade">GitHub</a> 
   </header> 
   <div style="text-align: left;color:cyan; margin-left: 30px"> 
    <p>🧐这里几乎涵盖了全部的斗鱼已有车队，数据从斗鱼抓取的，不定时进行更新，方便大家查找;</p> 
    <p>😘本网页是一次性加载所有图谱，网速慢的朋友请多等待，全部图片加载完毕再按瀑布流排版;</p> 
   </div> 
  </div> 
  <div class="container"> 
   <div class="content"> 
    <div class="grid"> 
     <!-- 			<div class="grid__item" data-size="1280x853"> <a href="images/weix/1.png" class="img-wrap"><img src="images/weix/1.png" alt="img1" />
				<div class="description description--grid">Assemblage</div>
				</a> </div>
			<div class="grid__item" data-size="958x1280"> <a href="images/weix/2.png" class="img-wrap"><img src="images/weix/2.png" alt="img2" />
				<div class="description description--grid">Demesne</div>
				</a> </div>
			<div class="grid__item" data-size="1280x853"> <a href="images/weix/3.png" class="img-wrap"><img src="images/weix/3.png" alt="img3" />
				<div class="description description--grid">Vestigial</div>
				</a> </div>
			<div class="grid__item" data-size="865x1280"> <a href="images/weix/4.png" class="img-wrap"><img src="images/weix/4.png" alt="img4" />
				<div class="description description--grid">Zephyr</div>
				</a> </div> --> 
    </div> 
    <!-- /grid --> 
    <div class="preview"> 
     <button class="action action--close"><i class="fa fa-times">x</i><span class="text-hidden">Close</span></button> 
     <div class="description description--preview"></div> 
    </div> 
    <!-- /preview --> 
   </div> 
  </div> 
  <!-- /container --> 
  <div style="text-align: center;color: yellow;font-size: 18px">Copyright &copy; Jade Bone. All rights reserved.
	<br>More Data Collect from <!-- 添加站长统计 -->
	<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1278032070'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1278032070%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
   </div>
  <script src="js/imagesloaded.pkgd.min.js"></script> 
  <script src="js/masonry.pkgd.min.js"></script> 
  <script src="js/classie.js"></script> 
  <script src="js/main.js"></script> 
  <script>
		function fetchGet() {
        fetch('https://raw.githubusercontent.com/wolf-scream/gift_effect/master/fleet_config.json',{
            method: 'GET',
            mode: 'cors', //请求模式为跨域
            cache: 'default', 
            credentials: 'same-origin', // 同源则加入凭据头,omit,include
				}).then(res => {
				    return res.text();
				}).then(result => {
				      // console.log('获取的结果', result);
				    result = result.substring(17, result.length-2);
            var jsonData = JSON.parse(result);
            jsonData=jsonData.data.list;
            // console.log(jsonData);
            var anchorNode = document.querySelector(".grid");
            for(let key in jsonData){
                if(jsonData[key].icon!=""){
                    var imgTag ="<a href='"+ jsonData[key].icon +"' class='img-wrap' style='text-decoration:none;'>";
                    imgTag+="<img src='"+ jsonData[key].icon +"' alt='all'>";
                    //imgTag+="<div class='description description--grid'>名称:" + jsonData[key].name;
                    imgTag+="<div class='description description--grid'>车标:" + jsonData[key].flag;  
                    imgTag+="   车号:"+ key +"   车名:"+jsonData[key].cname+"</div></a>"; 
                    var divTag = document.createElement("div");
                    divTag.setAttribute("class","grid__item");
                    divTag.setAttribute("data-size","1280x850");
                    divTag.innerHTML = imgTag;
                    anchorNode.appendChild(divTag);
                }       
            } 
            gridFx();
				}).catch(err => {
				    console.error('请求错误', err);
			})
    }
        fetchGet();
		// create SVG circle overlay and append it to the preview element
		function createCircleOverlay(previewEl) {
			var dummy = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
			dummy.setAttributeNS(null, 'version', '1.1');
			dummy.setAttributeNS(null, 'width', '100%');
			dummy.setAttributeNS(null, 'height', '100%');
			dummy.setAttributeNS(null, 'class', 'overlay');
			var g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
			var circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
			circle.setAttributeNS(null, 'cx', 0);
			circle.setAttributeNS(null, 'cy', 0);
			circle.setAttributeNS(null, 'r', Math.sqrt(Math.pow(previewEl.offsetWidth,2) + Math.pow(previewEl.offsetHeight,2)));
			dummy.appendChild(g);
			g.appendChild(circle);
			previewEl.appendChild(dummy);
		}

	 function gridFx(){
		  new GridFx(document.querySelector('.grid'), {
			onInit : function(instance) {
				createCircleOverlay(instance.previewEl);
			},
			onResize : function(instance) {
				instance.previewEl.querySelector('svg circle').setAttributeNS(null, 'r', Math.sqrt(Math.pow(instance.previewEl.offsetWidth,2) + Math.pow(instance.previewEl.offsetHeight,2)));
			},
			onOpenItem : function(instance, item) {
				// item's image
				var gridImg = item.querySelector('img'),
					gridImgOffset = gridImg.getBoundingClientRect(),
					win = {width: document.documentElement.clientWidth, height: window.innerHeight},
					SVGCircleGroupEl = instance.previewEl.querySelector('svg > g'),
					SVGCircleEl = SVGCircleGroupEl.querySelector('circle');
					
				SVGCircleEl.setAttributeNS(null, 'r', Math.sqrt(Math.pow(instance.previewEl.offsetWidth,2) + Math.pow(instance.previewEl.offsetHeight,2)));
				// set the transform for the SVG g node. This will animate the circle overlay. The origin of the circle depends on the position of the clicked item.
				if( gridImgOffset.left + gridImg.offsetWidth/2 < win.width/2 ) {
					SVGCircleGroupEl.setAttributeNS(null, 'transform', 'translate(' + win.width + ', ' + (gridImgOffset.top + gridImg.offsetHeight/2 < win.height/2 ? win.height : 0) + ')');
				}
				else {
					SVGCircleGroupEl.setAttributeNS(null, 'transform', 'translate(0, ' + (gridImgOffset.top + gridImg.offsetHeight/2 < win.height/2 ? win.height : 0) + ')');
				}
			}
		});
	}
</script>   
 </body>
</html>
